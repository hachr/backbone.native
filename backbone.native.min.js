(function(){"use strict";function o(e){if(!e[n]){e[n]=s.length===0?++r:s.pop()}var t=e[n];return i[t]||(i[t]=[])}function u(e){var t=e[n];if(i[t]){i[t]=null;e[n]=null;s.push(t)}}function a(n,r,i,s){if(typeof i==="function"){s=i;i=null}var u=e.exec(r);r=u[1]||null;var a=u[2]||null;if(!r)return;var f=s;var l=s;if(i){f=function(e){for(var r=e.target;r&&r!==n;r=r.parentElement){if(t.call(r,i)){var s=l.call(r,e,r);if(s===false){e.stopPropagation();e.preventDefault()}return s}}}}else{f=function(e){var t=l.call(n,e,n);if(t===false){e.stopPropagation();e.preventDefault()}return t}}n.addEventListener(r,f,false);o(n).push({eventName:r,callback:s,handler:f,namespace:a,selector:i})}function f(t,n,r,i){if(typeof r==="function"){i=r;r=null}var s=e.exec(n||"");n=s[1];var a=s[2];var f=o(t)||[];if(!n&&!a&&!r&&!i){f.forEach(function(e){t.removeEventListener(e.eventName,e.handler,false)});u(t)}else{var l=f.filter(function(e){return(!a||e.namespace===a)&&(!n||e.eventName===n)&&(!i||e.callback===i)&&(!r||e.selector===r)});l.forEach(function(e){t.removeEventListener(e.eventName,e.handler,false);f.splice(f.indexOf(e),1)});if(f.length===0)u(t)}}function l(e,t){t=t||document;if(!(this instanceof l))return new l(e,t);if(!e){this.length=0}else if(typeof e==="string"){if(/^\s*</.test(e)){var n=document.createElement("div");n.innerHTML=e;this[0]=n.firstChild;n.removeChild(n.firstChild);this.length=1}else{if(e[0]==="#"){e=document.getElementById(e)}else{e=t.querySelector(e)}if(e!==null){this[0]=e;this.length=1}else{this.length=0}}}else{this[0]=e;this.length=1}}var e=/^([^.]+)?(?:\.([^.]+))?$/;var t=Element.prototype.matchesSelector||null;if(!t){["webkit","moz","o","ms"].forEach(function(e){var n=Element.prototype[e+"MatchesSelector"];if(n)t=n})}var n="backboneNativeKey"+Math.random();var r=1;var i={};var s=[];l.prototype={hide:null,appendTo:null,find:null,attr:function(e){Object.keys(e).forEach(function(t){switch(t){case"html":this[0].innerHTML=e[t];break;case"text":this[0].textContent=e[t];break;case"class":this[0].className=e[t];break;default:this[0].setAttribute(t,e[t]);break}},this);return this},html:function(e){this[0].innerHTML=e;return this},remove:function(){var e=this[0];if(e.parentElement)e.parentElement.removeChild(e);(function t(e){f(e);for(var n=0,r=e.childNodes.length;n<r;n++){if(e.childNodes[n].nodeType!==Node.TEXT_NODE){t(e.childNodes[n])}}})(e);return this},on:function(e,t,n){a(this[0],e,t,n);return this},off:function(e,t,n){f(this[0],e,t,n);return this},bind:function(e,t){return this.on(e,t)},unbind:function(e,t){return this.off(e,t)},delegate:function(e,t,n){return this.on(t,e,n)},undelegate:function(e,t,n){return this.off(t,e,n)}};l.ajax=function(e){e=e||{};var t=e.type||"GET";var n=e.url;var r=e.processData===undefined?true:!!e.processData;var i=e.data;if(r&&typeof i==="object"){var s=Object.keys(i).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(i[e])});i=s.join("&")}if(i&&(t==="GET"||t==="HEAD")){n+=(n.indexOf("?")===-1?"?":"&")+i;i=undefined}var o=new XMLHttpRequest;o.open(t,n,true);if(e.contentType)o.setRequestHeader("Content-Type",e.contentType);if(e.beforeSend)e.beforeSend(o);o.onload=function(){var t=false;var n=o.responseText;if(e.dataType==="json"){try{n=JSON.parse(n)}catch(r){t=true}}if(!t&&o.status>=200&&o.status<300){if(e.success)e.success(n,o.statusText,o)}else{if(e.error)e.error(o)}};o.onerror=o.onabort=function(){if(e.error)e.error(o)};o.send(i);return o};l.on=a;l.off=f;if(typeof exports!=="undefined"){module.exports=l}else{var c=this;var h=c.Backbone?c.Backbone.Native:null;var p=c.$;if(c.Backbone)c.Backbone.Native=l;c.$=l;l.noConflict=function(e){c.$=p;if(e)c.Backbone.Native=h;return l};if(c.Backbone){if(c.Backbone.setDomLibrary){c.Backbone.setDomLibrary(l)}else{c.Backbone.$=l}}}}).call(this)
